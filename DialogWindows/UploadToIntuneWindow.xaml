<Window x:Class="IntunePackagingTool.UploadToIntuneWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Upload to Microsoft Intune" 
        Height="700" Width="900"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="#F5F7FA">
    
    <Window.Resources>
        <!-- Modern Button Style -->
        <Style TargetType="Button" x:Key="ModernButton">
            <Setter Property="Background" Value="#007BFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style TargetType="Button" x:Key="SecondaryButton" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#6C757D"/>
        </Style>

        <Style TargetType="Button" x:Key="SuccessButton" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#28A745"/>
        </Style>

        <!-- TextBox Style -->
        <Style TargetType="TextBox" x:Key="ModernTextBox">
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderBrush" Value="#CED4DA"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Background" Value="White"/>
        </Style>

        <!-- ComboBox Style -->
        <Style TargetType="ComboBox" x:Key="ModernComboBox">
            <Setter Property="Padding" Value="12"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#CED4DA"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="â˜ï¸ Upload Application to Microsoft Intune" FontSize="24" FontWeight="SemiBold" Foreground="#212529"/>
            <TextBlock Name="AppSummaryText" Text="Adobe Reader v2023.1.0" FontSize="14" Foreground="#6C757D" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                
                <!-- Application Settings -->
                <Border Background="White" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="ðŸ“± Application Settings" FontSize="16" FontWeight="SemiBold" Foreground="#212529" Margin="0,0,0,15"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Install Context:" VerticalAlignment="Center" FontSize="13" FontWeight="Medium" Foreground="#6C757D"/>
                            <ComboBox Grid.Row="0" Grid.Column="1" Name="InstallContextCombo" Style="{StaticResource ModernComboBox}">
                                <ComboBoxItem Content="System" IsSelected="True"/>
                                <ComboBoxItem Content="User"/>
                            </ComboBox>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Install Command:" VerticalAlignment="Center" FontSize="13" FontWeight="Medium" Foreground="#6C757D"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Name="InstallCommandTextBox" Style="{StaticResource ModernTextBox}" Text="Deploy-Application.exe -DeploymentType &quot;Install&quot; -DeployMode &quot;Silent&quot;"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Uninstall Command:" VerticalAlignment="Center" FontSize="13" FontWeight="Medium" Foreground="#6C757D"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Name="UninstallCommandTextBox" Style="{StaticResource ModernTextBox}" Text="Deploy-Application.exe -DeploymentType &quot;Uninstall&quot; -DeployMode &quot;Silent&quot;"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Description:" VerticalAlignment="Top" Margin="0,12,0,0" FontSize="13" FontWeight="Medium" Foreground="#6C757D"/>
                            <TextBox Grid.Row="3" Grid.Column="1" Name="DescriptionTextBox" Style="{StaticResource ModernTextBox}" Height="80" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" Text="Application packaged with NBB PSADT Tools"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Detection Rules -->
                <Border Background="White" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="ðŸ” Detection Rules" FontSize="16" FontWeight="SemiBold" Foreground="#212529" Margin="0,0,0,15"/>
                        
                        <!-- Detection Rules List -->
                        <ItemsControl Name="DetectionRulesList" Margin="0,0,0,15">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#F8F9FA" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="4" Padding="15" Margin="0,0,0,10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="16" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding Title}" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="{Binding Description}" FontSize="11" Foreground="#6C757D"/>
                                            </StackPanel>
                                            <Button Grid.Column="2" Content="âŒ" Background="Transparent" BorderThickness="0" FontSize="12" Cursor="Hand" ToolTip="Remove Rule" Click="RemoveDetectionRule_Click" Tag="{Binding}"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        
                        <!-- Add Detection Rules -->
                        <StackPanel Orientation="Horizontal">
                            <Button Name="AddFileDetectionButton" Content="ðŸ“ Add File Detection" Style="{StaticResource SecondaryButton}" Click="AddFileDetectionButton_Click"/>
                            <Button Name="AddRegistryDetectionButton" Content="ðŸ—ƒï¸ Add Registry Detection" Style="{StaticResource SecondaryButton}" Click="AddRegistryDetectionButton_Click"/>
                            <Button Name="AddScriptDetectionButton" Content="ðŸ’» Add Script Detection" Style="{StaticResource SecondaryButton}" Click="AddScriptDetectionButton_Click"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- App Icon -->
                <Border Background="White" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="8" Padding="20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="ðŸŽ¨ Application Icon" FontSize="16" FontWeight="SemiBold" Foreground="#212529" Margin="0,0,0,15"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" Width="64" Height="64" Background="#F8F9FA" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="8" Margin="0,0,15,0">
                                <TextBlock Text="ðŸ“±" FontSize="32" HorizontalAlignment="Center" VerticalAlignment="Center" Name="DefaultIconText"/>
                            </Border>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Application Icon (Optional)" FontWeight="Medium" FontSize="13"/>
                                <TextBlock Text="Select a PNG or ICO file to represent your application" FontSize="11" Foreground="#6C757D" Margin="0,2,0,10"/>
                                <Button Name="BrowseIconButton" Content="ðŸ“ Browse Icon..." Style="{StaticResource SecondaryButton}" Click="BrowseIconButton_Click" HorizontalAlignment="Left"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Upload Progress -->
                <Border Name="UploadProgressPanel" Background="White" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="8" Padding="20" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="ðŸ“¤ Upload Progress" FontSize="16" FontWeight="SemiBold" Foreground="#212529" Margin="0,0,0,15"/>
                        
                        <ProgressBar Name="UploadProgressBar" Height="20" Minimum="0" Maximum="100" Value="0" Margin="0,0,0,10"/>
                        <TextBlock Name="UploadStatusText" Text="Preparing upload..." FontSize="12" Foreground="#6C757D"/>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button x:Name="CancelButton" Content="Cancel" Style="{StaticResource SecondaryButton}" Click="CancelButton_Click"/>
            <Button Name="UploadButton" Content=" Create and Upload to Intune" Style="{StaticResource SuccessButton}" Click="UploadButton_Click"/>
        </StackPanel>

    </Grid>
</Window>