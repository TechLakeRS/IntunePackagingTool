<Window x:Class="IntunePackagingTool.Views.PSADTConfigDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Configure PSADT Options" 
        Height="750" 
        Width="1000"
        WindowStartupLocation="CenterOwner"
        Background="#F5F7FA"
        ShowInTaskbar="False"
        ResizeMode="NoResize">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with gradient -->
        <Border Grid.Row="0" Padding="30,20">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#667EEA" Offset="0"/>
                    <GradientStop Color="#764BA2" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0">
                    <TextBlock Text="⚙️ Configure PSADT Options" FontSize="24" FontWeight="Light" Foreground="White"/>
                    <TextBlock Name="PackageInfoText"
                              Text="Select PowerShell App Deployment Toolkit functions to inject into your package"
                              FontSize="14"
                              Foreground="White"
                              Opacity="0.9"
                              Margin="0,4,0,0"/>
                </StackPanel>

                <!-- Search Box -->
                <Border Grid.Row="1" Background="White" CornerRadius="20" Padding="12,8" Margin="0,16,0,0" Opacity="0.95">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="🔍" FontSize="16" VerticalAlignment="Center" Margin="4,0,8,0"/>
                        <TextBox Name="SearchBox"
                                Grid.Column="1"
                                BorderThickness="0"
                                Background="Transparent"
                                VerticalAlignment="Center"
                                FontSize="14"
                                TextChanged="SearchBox_TextChanged"
                                GotFocus="SearchBox_GotFocus"
                                LostFocus="SearchBox_LostFocus"/>
                        <TextBlock Name="SearchPlaceholder"
                                  Grid.Column="1"
                                  Text="Search options..."
                                  IsHitTestVisible="False"
                                  Foreground="#999"
                                  FontSize="14"
                                  VerticalAlignment="Center"/>
                        <Button Name="ClearSearchButton"
                               Grid.Column="2"
                               Content="✕"
                               Padding="8,4"
                               Background="Transparent"
                               BorderThickness="0"
                               Foreground="#999"
                               FontSize="14"
                               Click="ClearSearch_Click"
                               Cursor="Hand"/>
                    </Grid>
                </Border>

                <!-- Quick Presets -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Border Background="White" CornerRadius="20" Padding="16,8" Opacity="0.95">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Quick Presets:" VerticalAlignment="Center" Margin="0,0,16,0" FontWeight="Medium"/>
                            <Button Name="PresetBasicButton" Content="📦 Basic" Margin="0,0,8,0" Padding="12,6" Click="PresetBasic_Click"/>
                            <Button Name="PresetSilentButton" Content="🤫 Silent" Margin="0,0,8,0" Padding="12,6" Click="PresetSilent_Click"/>
                            <Button Name="PresetEnterpriseButton" Content="🏢 Enterprise" Margin="0,0,8,0" Padding="12,6" Click="PresetEnterprise_Click"/>
                            <Button Name="ClearAllButton" Content="🔄 Clear All" Padding="12,6" Click="ClearAll_Click"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content with Tabs -->
        <TabControl Grid.Row="1" Margin="24" Background="White" BorderThickness="1" BorderBrush="#E9ECEF">

            <!-- Installation Tab -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔧" Margin="0,0,8,0"/>
                        <TextBlock Text="Installation"/>
                    </StackPanel>
                </TabItem.Header>

                <ScrollViewer Padding="24">
                    <StackPanel>
                        <!-- Basic Installation Options -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="BASIC OPTIONS" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <UniformGrid Columns="2">
                                    <CheckBox Name="SilentInstallCheck"
                                             Content="Silent Installation"
                                             Margin="0,0,0,8"
                                             ToolTip="Run without user interaction (/quiet)"/>
                                    <CheckBox Name="AllUsersInstallCheck"
                                             Content="Install for All Users"
                                             Margin="0,0,0,8"
                                             ToolTip="System-wide installation (ALLUSERS=1)"/>
                                    <CheckBox Name="SuppressRestartCheck"
                                             Content="Suppress Restart"
                                             Margin="0,0,0,8"
                                             ToolTip="Prevent automatic system restart (/norestart)"/>
                                    <CheckBox Name="VerboseLoggingCheck"
                                             Content="Verbose Logging"
                                             Margin="0,0,0,8"
                                             ToolTip="Detailed installation logs"/>
                                </UniformGrid>
                            </StackPanel>
                        </Border>

                        <!-- Advanced Installation Options -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="ADVANCED OPTIONS" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="CreateInstallMarkerCheck" 
                                         Content="Create Installation Marker" 
                                         Margin="0,0,0,8"
                                         ToolTip="Registry marker for detection"/>
                                <CheckBox Name="RemovePreviousVersionsCheck" 
                                         Content="Remove Previous Versions" 
                                         Margin="0,0,0,8"
                                         ToolTip="Remove-MSIApplications for old versions"/>
                                <CheckBox Name="WaitForProcessCompletionCheck" 
                                         Content="Wait for Process Completion" 
                                         Margin="0,0,0,8"
                                         ToolTip="While loop to wait for installation to complete"/>
                                <CheckBox Name="UninstallPreviousByCodeCheck" 
                                         Content="Uninstall by MSI Code" 
                                         Margin="0,0,0,8"
                                         ToolTip="Uninstall specific MSI codes before installing"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Prerequisites Tab -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔍" Margin="0,0,8,0"/>
                        <TextBlock Text="Prerequisites"/>
                    </StackPanel>
                </TabItem.Header>

                <ScrollViewer Padding="24">
                    <StackPanel>
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="DEPENDENCY CHECKS" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="CheckDotNetCheck" 
                                         Content="Check .NET Framework" 
                                         Margin="0,0,0,8"
                                         ToolTip="Verify .NET Framework 4.8 or higher"/>
                                <CheckBox Name="CheckVCRedistCheck" 
                                         Content="Check Visual C++ Redistributables" 
                                         Margin="0,0,0,8"
                                         ToolTip="Validate VC++ runtime dependencies"/>
                                <CheckBox Name="CheckDiskSpaceCheck" 
                                         Content="Check Available Disk Space" 
                                         Margin="0,0,0,8"
                                         ToolTip="Validate sufficient disk space"/>
                                <CheckBox Name="ImportCertificatesCheck" 
                                         Content="Import Certificates" 
                                         Margin="0,0,0,8"
                                         ToolTip="Add certificates to Trusted Publishers store"/>
                                <CheckBox Name="RegisterDLLsCheck" 
                                         Content="Register DLL Modules" 
                                         Margin="0,0,0,8"
                                         ToolTip="Register COM components (Register-DLL)"/>
                                <CheckBox Name="ImportDriversCheck" 
                                         Content="Import Drivers (PnPutil)" 
                                         Margin="0,0,0,8"
                                         ToolTip="Import signed drivers to system"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- User Interaction Tab -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="👥" Margin="0,0,8,0"/>
                        <TextBlock Text="User Interaction"/>
                    </StackPanel>
                </TabItem.Header>

                <ScrollViewer Padding="24">
                    <StackPanel>
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="USER EXPERIENCE" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="CloseRunningAppsCheck" 
                                         Content="Close Running Applications" 
                                         Margin="0,0,0,8"
                                         ToolTip="Show-InstallationWelcome -CloseApps"/>
                                <CheckBox Name="AllowUserDeferralsCheck" 
                                         Content="Allow User Deferrals" 
                                         Margin="0,0,0,8"
                                         ToolTip="Allow users to postpone installation"/>
                                <CheckBox Name="ShowProgressCheck" 
                                         Content="Show Installation Progress" 
                                         Margin="0,0,0,8"
                                         ToolTip="Display progress dialog during installation"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Registry & Files Tab -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="📁" Margin="0,0,8,0"/>
                        <TextBlock Text="Registry  Files"/>
                    </StackPanel>
                </TabItem.Header>

                <ScrollViewer Padding="24">
                    <StackPanel>
                        <!-- Registry Operations -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="REGISTRY OPERATIONS" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="SetHKCUAllUsersCheck" 
                                         Content="Set HKCU Registry for All Users" 
                                         Margin="0,0,0,8"
                                         ToolTip="Invoke-HKCURegistrySettingsForAllUsers"/>
                                <CheckBox Name="SetCustomRegistryCheck" 
                                         Content="Set Custom Registry Keys" 
                                         Margin="0,0,0,8"
                                         ToolTip="Set-RegistryKey for custom settings"/>
                                <CheckBox Name="ImportRegFileCheck" 
                                         Content="Import Registry File (.reg)" 
                                         Margin="0,0,0,8"
                                         ToolTip="Import a .reg file during installation"/>
                            </StackPanel>
                        </Border>

                        <!-- File Operations -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="FILE OPERATIONS" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="CopyToAllUsersCheck" 
                                         Content="Copy Files to All User Profiles" 
                                         Margin="0,0,0,8"
                                         ToolTip="Get-UserProfiles | ForEach Profile"/>
                                <CheckBox Name="CopyConfigFilesCheck" 
                                         Content="Copy Configuration Files" 
                                         Margin="0,0,0,8"
                                         ToolTip="Copy-File for custom configs"/>
                                <CheckBox Name="ModifyFilePermissionsCheck" 
                                         Content="Modify File/Folder Permissions (ACL)" 
                                         Margin="0,0,0,8"
                                         ToolTip="Set permissions on files/folders"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Shortcuts & Cleanup Tab -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔗" Margin="0,0,8,0"/>
                        <TextBlock Text="Shortcuts  Cleanup"/>
                    </StackPanel>
                </TabItem.Header>

                <ScrollViewer Padding="24">
                    <StackPanel>
                        <!-- Shortcuts -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="SHORTCUT CREATION" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="DesktopShortcutCheck" 
                                         Content="Create Desktop Shortcut" 
                                         Margin="0,0,0,8"
                                         ToolTip="New-Shortcut on $envCommonDesktop"/>
                                <CheckBox Name="StartMenuEntryCheck" 
                                         Content="Create Start Menu Entry" 
                                         Margin="0,0,0,8"
                                         ToolTip="New-Shortcut in $envCommonStartMenuPrograms"/>
                            </StackPanel>
                        </Border>

                        <!-- Cleanup Operations -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="CLEANUP OPERATIONS" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="RemoveSpecificFilesCheck" 
                                         Content="Remove Specific Files" 
                                         Margin="0,0,0,8"
                                         ToolTip="Remove-File for cleanup of old files"/>
                                <CheckBox Name="RemoveEmptyFoldersCheck" 
                                         Content="Remove Empty Folders" 
                                         Margin="0,0,0,8"
                                         ToolTip="Clean up empty directories after uninstall"/>
                                <CheckBox Name="UnregisterDLLsCheck" 
                                         Content="Unregister Old DLLs" 
                                         Margin="0,0,0,8"
                                         ToolTip="UnRegister-DLL for old components"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Advanced Tab -->
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="⚡" Margin="0,0,8,0"/>
                        <TextBlock Text="Advanced"/>
                    </StackPanel>
                </TabItem.Header>

                <ScrollViewer Padding="24">
                    <StackPanel>
                        <!-- System Configuration -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="SYSTEM CONFIGURATION" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="AddToPathCheck" 
                                         Content="Add to PATH Environment Variable" 
                                         Margin="0,0,0,8"
                                         ToolTip="Add application to system PATH"/>
                                <CheckBox Name="CreateActiveSetupCheck" 
                                         Content="Create Active Setup (Per-User)" 
                                         Margin="0,0,0,8"
                                         ToolTip="Run once per user (NOT recommended - see documentation)"/>
                            </StackPanel>
                        </Border>

                        <!-- Legacy Support -->
                        <Border Background="#F8F9FA" CornerRadius="6" Padding="16">
                            <StackPanel>
                                <TextBlock Text="LEGACY SUPPORT" FontSize="11" FontWeight="Bold" Foreground="#6C757D" Margin="0,0,0,12"/>
                                <CheckBox Name="ExecuteVBScriptCheck" 
                                         Content="Execute VBScript" 
                                         Margin="0,0,0,8"
                                         ToolTip="Run VBScript for legacy apps"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Footer -->
        <Border Grid.Row="2" Background="White" Padding="30,20" BorderBrush="#E9ECEF" BorderThickness="0,1,0,0">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#E3F2FD" CornerRadius="20" Padding="16,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Selected: " FontSize="14"/>
                            <TextBlock Name="SelectedCountText" Text="0 options" FontSize="14" FontWeight="Bold" Foreground="#3498DB" Margin="4,0,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Name="CancelButton" 
                            Content="Cancel" 
                            Width="120"
                            Height="36"
                            Margin="0,0,12,0"
                            Background="White"
                            BorderBrush="#DEE2E6"
                            BorderThickness="1"
                            Click="Cancel_Click"/>
                    <Button Name="ApplyButton" 
                            Content="✅ Apply Configuration"
                            Width="180"
                            Height="36"
                            Background="#3498DB"
                            Foreground="White"
                            BorderThickness="0"
                            IsDefault="True"
                            Click="Apply_Click"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>