<!-- Complete MainWindow.xaml with Sidebar Layout -->
<Window x:Class="IntunePackagingTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="NBB Application Packaging Tools" 
        Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="#F5F7FA">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <!-- Sidebar -->
            <ColumnDefinition Width="*"/>
            <!-- Main content -->
        </Grid.ColumnDefinitions>

        <!-- SIDEBAR -->
        <Border Grid.Column="0" Background="#2C3E50">
            <Border.Effect>
                <DropShadowEffect Color="Black" Opacity="0.15" ShadowDepth="4" BlurRadius="12"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- Header -->
                    <RowDefinition Height="*"/>
                    <!-- Navigation -->
                    <RowDefinition Height="Auto"/>
                    <!-- User Info -->
                </Grid.RowDefinitions>

                <!-- App Header -->
                <Border Grid.Row="0" Background="#34495E" Padding="24,20">
                    <StackPanel>
                        <Border Background="#3498DB" Width="48" Height="48" CornerRadius="12" Margin="0,0,0,12">
                            <TextBlock Text="📦" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="NBB Intune Tools" FontSize="18" FontWeight="SemiBold" Foreground="White"/>
                        <TextBlock Text="Application Packaging" FontSize="12" Foreground="#BDC3C7" Margin="0,2,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Navigation Items -->
                <StackPanel Grid.Row="1" Margin="16,24,16,0">

                    <!-- Dashboard -->
                    <Button Name="DashboardNavButton" Style="{StaticResource ActiveSidebarNavButton}" Click="DashboardNavButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Border Background="#E74C3C" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                <TextBlock Text="📊" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Dashboard" FontSize="14" FontWeight="Medium" Foreground="White"/>
                                <TextBlock Text="Overview - Stats" FontSize="10" Foreground="#BDC3C7"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <!-- Create Application -->
                    <Button Name="CreateAppNavButton" Style="{StaticResource SidebarNavButton}" Click="CreateAppNavButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Border Background="#27AE60" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                <TextBlock Text="➕" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Create Package" FontSize="14" FontWeight="Medium" Foreground="White"/>
                                <TextBlock Text="New application" FontSize="10" Foreground="#BDC3C7"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <!-- View Applications -->
                    <Button Name="ViewAppsNavButton" Style="{StaticResource SidebarNavButton}" Click="ViewAppsNavButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Border Background="#9B59B6" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                <TextBlock Text="📱" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Applications" FontSize="14" FontWeight="Medium" Foreground="White"/>
                                <TextBlock Text="Browse - manage" FontSize="10" Foreground="#BDC3C7"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <!-- Upload History -->
                    <Button Name="HistoryNavButton" Style="{StaticResource SidebarNavButton}" Click="HistoryNavButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Border Background="#F39C12" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                <TextBlock Text="📝" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Upload History" FontSize="14" FontWeight="Medium" Foreground="White"/>
                                <TextBlock Text="Recent uploads" FontSize="10" Foreground="#BDC3C7"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <!-- Settings -->
                    <Button Name="SettingsNavButton" Style="{StaticResource SidebarNavButton}" Click="SettingsNavButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <Border Background="#95A5A6" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                <TextBlock Text="⚙️" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Settings" FontSize="14" FontWeight="Medium" Foreground="White"/>
                                <TextBlock Text="Configuration" FontSize="10" Foreground="#BDC3C7"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- User Info at Bottom -->
                <Border Grid.Row="2" Background="#34495E" Padding="20" Margin="0,20,0,0">
                    <StackPanel Orientation="Horizontal">
                        <Border Background="#3498DB" Width="32" Height="32" CornerRadius="16" Margin="0,0,12,0">
                            <TextBlock Text="RS" FontSize="12" FontWeight="Bold" Foreground="White" 
                                     HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Riyadh Sarker" FontSize="12" FontWeight="Medium" Foreground="White"/>
                            <TextBlock Text="NBB Admin" FontSize="10" Foreground="#BDC3C7"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- MAIN CONTENT AREA -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Header -->
                <RowDefinition Height="*"/>
                <!-- Content -->
                <RowDefinition Height="Auto"/>
                <!-- Status -->
            </Grid.RowDefinitions>

            <!-- Page Header -->
            <Border Grid.Row="0" Background="White" Padding="32,20" BorderBrush="#E9ECEF" BorderThickness="0,0,0,1">
                <Grid>
                    <StackPanel>
                        <TextBlock Name="PageTitle" Text="Dashboard" FontSize="28" FontWeight="Light" Foreground="#2C3E50"/>
                        <TextBlock Name="PageSubtitle" Text="Application packaging overview and quick actions" 
                                 FontSize="14" Foreground="#7F8C8D" Margin="0,4,0,0"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <Button Name="RefreshButton" Content="🔄 Refresh" Style="{StaticResource SecondaryButton}" Margin="0,0,8,0" Click="RefreshButton_Click"/>
                        <Button Name="DebugTestButton" Content="🔍 Debug" Style="{StaticResource SecondaryButton}" Click="DebugTest_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Content Container -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="32">
                <Grid Name="MainContentGrid">

                    <!-- DASHBOARD PAGE -->
                    <Grid Name="DashboardPage" Visibility="Visible">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Stats Cards -->
                            <UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,32">
                                <!-- Total Applications -->
                                <Border Style="{StaticResource ModernCard}" Margin="0,0,8,0">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="#E8F5E9" Width="40" Height="40" CornerRadius="10" Margin="0,0,12,0">
                                                <TextBlock Text="📱" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Total Apps" FontSize="12" Foreground="#7F8C8D"/>
                                                <TextBlock Text="247" FontSize="24" FontWeight="Light" Foreground="#2C3E50"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Successful Uploads -->
                                <Border Style="{StaticResource ModernCard}" Margin="8,0">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="#E8F5E9" Width="40" Height="40" CornerRadius="10" Margin="0,0,12,0">
                                                <TextBlock Text="✅" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Successful" FontSize="12" Foreground="#7F8C8D"/>
                                                <TextBlock Text="234" FontSize="24" FontWeight="Light" Foreground="#27AE60"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Pending -->
                                <Border Style="{StaticResource ModernCard}" Margin="8,0">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="#FFF3E0" Width="40" Height="40" CornerRadius="10" Margin="0,0,12,0">
                                                <TextBlock Text="⏳" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Pending" FontSize="12" Foreground="#7F8C8D"/>
                                                <TextBlock Text="8" FontSize="24" FontWeight="Light" Foreground="#F39C12"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Failed -->
                                <Border Style="{StaticResource ModernCard}" Margin="8,0,0,0">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="#FFEBEE" Width="40" Height="40" CornerRadius="10" Margin="0,0,12,0">
                                                <TextBlock Text="❌" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Failed" FontSize="12" Foreground="#7F8C8D"/>
                                                <TextBlock Text="5" FontSize="24" FontWeight="Light" Foreground="#E74C3C"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>

                            <!-- Quick Actions -->
                            <Border Grid.Row="1" Style="{StaticResource ModernCard}" Margin="0,0,0,32">
                                <StackPanel>
                                    <TextBlock Text="🚀 Quick Actions" FontSize="18" FontWeight="Medium" Margin="0,0,0,20"/>
                                    <UniformGrid Columns="3">
                                        <Button Content="➕ New Package" Style="{StaticResource ModernButton}" Margin="0,0,8,0" Click="CreateAppNavButton_Click"/>
                                        <Button Content="📂 Browse Packages" Style="{StaticResource SecondaryButton}" Margin="8,0" Click="ViewAppsNavButton_Click"/>
                                        <Button Content="☁️ Upload to Intune" Style="{StaticResource ModernButton}" Background="#27AE60" Margin="8,0,0,0"/>
                                    </UniformGrid>
                                </StackPanel>
                            </Border>

                            <!-- Recent Activity -->
                            <Border Grid.Row="2" Style="{StaticResource ModernCard}">
                                <StackPanel>
                                    <TextBlock Text="📝 Recent Activity" FontSize="18" FontWeight="Medium" Margin="0,0,0,20"/>
                                    <TextBlock Text="Recent uploads and package creations will appear here..." 
                                             FontSize="14" Foreground="#7F8C8D" FontStyle="Italic"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>

                    <!-- CREATE APPLICATION PAGE -->
                    <Grid Name="CreateApplicationPage" Visibility="Collapsed">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="350"/>
                        </Grid.ColumnDefinitions>

                        <!-- Main Form -->
                        <StackPanel Grid.Column="0" Margin="0,0,20,0">

                            <!-- Application Information -->
                            <Border Style="{StaticResource ModernCard}">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                                        <Border Background="#E3F2FD" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                            <TextBlock Text="ℹ️" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <TextBlock Text="Application Information" FontSize="18" FontWeight="Medium" VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Manufacturer -->
                                        <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,12,0">
                                            <TextBlock Text="Manufacturer" FontSize="12" FontWeight="Medium" Foreground="#6C757D" Margin="0,0,0,4"/>
                                            <TextBox Name="ManufacturerTextBox" Style="{StaticResource ModernTextBox}"/>
                                        </StackPanel>

                                        <!-- Application Name -->
                                        <StackPanel Grid.Row="0" Grid.Column="1">
                                            <TextBlock Text="Application Name" FontSize="12" FontWeight="Medium" Foreground="#6C757D" Margin="0,0,0,4"/>
                                            <TextBox Name="AppNameTextBox" Style="{StaticResource ModernTextBox}"/>
                                        </StackPanel>

                                        <!-- Version -->
                                        <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,12,0">
                                            <TextBlock Text="Version" FontSize="12" FontWeight="Medium" Foreground="#6C757D" Margin="0,0,0,4"/>
                                            <TextBox Name="VersionTextBox" Style="{StaticResource ModernTextBox}"/>
                                        </StackPanel>

                                        <!-- Sources Path with Browse Button -->
                                        <StackPanel Grid.Row="1" Grid.Column="1">
                                            <TextBlock Text="Sources Path" FontSize="12" FontWeight="Medium" Foreground="#6C757D" Margin="0,0,0,4"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <TextBox Name="SourcesPathTextBox" Grid.Column="0" Style="{StaticResource ModernTextBox}" Margin="0,0,8,0"/>
                                                <Button Name="BrowseSourcesButton" Grid.Column="1" Content="📁 Browse..." 
                                                Click="BrowseSourcesButton_Click" Style="{StaticResource SecondaryButton}" 
                                                VerticalAlignment="Stretch" MinWidth="100"/>
                                            </Grid>
                                        </StackPanel>

                                        <!-- Advanced Options Expander -->
                                        <Expander Grid.Row="2" Grid.ColumnSpan="2" Name="AdvancedOptionsExpander" 
                                           Header="Advanced Options" IsExpanded="False" Margin="0,16,0,0"
                                           Background="Transparent" BorderThickness="0">
                                            <Expander.HeaderTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Background="#F8F9FA" Width="24" Height="24" CornerRadius="6" Margin="0,0,8,0">
                                                            <TextBlock Text="⚙️" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                        <TextBlock Text="{Binding}" FontSize="14" FontWeight="Medium" Foreground="#495057" VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Expander.HeaderTemplate>

                                            <Border Background="#F8F9FA" CornerRadius="8" Padding="20" Margin="0,8,0,0">
                                                <StackPanel>
                                                    <!-- Package Type Detection -->
                                                    <Grid Margin="0,0,0,20">
                                                        <StackPanel>
                                                            <TextBlock Text="Detected Package Type" FontSize="12" FontWeight="Medium" Foreground="#6C757D" Margin="0,0,0,4"/>
                                                            <Border Background="White" BorderBrush="#DEE2E6" BorderThickness="1" CornerRadius="4" Padding="12">
                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock Name="DetectedPackageTypeIcon" Text="❓" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                                                    <TextBlock Name="DetectedPackageTypeText" Text="Select source file to detect type" 
                                                         FontSize="14" Foreground="#6C757D" VerticalAlignment="Center" FontWeight="Medium"/>
                                                                </StackPanel>
                                                            </Border>
                                                        </StackPanel>
                                                    </Grid>

                                                    <!-- PSADT Installation Options -->
                                                    <StackPanel Name="PSADTOptionsPanel" Visibility="Collapsed">

                                                        <!-- Installation Options -->
                                                        <StackPanel Margin="0,0,0,20">
                                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                                                <Border Background="#3498DB" Width="20" Height="20" CornerRadius="4" Margin="0,0,8,0">
                                                                    <TextBlock Text="🔧" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="Installation Options" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                            </StackPanel>

                                                            <UniformGrid Columns="2" Margin="16,0,0,0">
                                                                <CheckBox Name="SilentInstallCheck" Content="Silent Installation" IsChecked="True" Margin="0,0,0,8" 
                                                      ToolTip="Run without user interaction (/quiet)"/>
                                                                <CheckBox Name="SuppressRestartCheck" Content="Suppress Restart" IsChecked="True" Margin="0,0,0,8"
                                                      ToolTip="Prevent automatic system restart (/norestart)"/>
                                                                <CheckBox Name="AllUsersInstallCheck" Content="Install for All Users" IsChecked="True" Margin="0,0,0,8"
                                                      ToolTip="System-wide installation (ALLUSERS=1)"/>
                                                                <CheckBox Name="VerboseLoggingCheck" Content="Verbose Logging" Margin="0,0,0,8"
                                                      ToolTip="Detailed installation logs"/>
                                                            </UniformGrid>
                                                        </StackPanel>

                                                        <!-- User Interaction -->
                                                        <StackPanel Margin="0,0,0,20">
                                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                                                <Border Background="#E74C3C" Width="20" Height="20" CornerRadius="4" Margin="0,0,8,0">
                                                                    <TextBlock Text="👥" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="User Interaction" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                            </StackPanel>

                                                            <UniformGrid Columns="2" Margin="16,0,0,0">
                                                                <CheckBox Name="CloseRunningAppsCheck" Content="Close Running Applications" IsChecked="True" Margin="0,0,0,8"
                                                                    ToolTip="Show-InstallationWelcome -CloseApps"/>
                                                                <CheckBox Name="AllowUserDeferralsCheck" Content="Allow User Deferrals" IsChecked="True" Margin="0,0,0,8"
                                                                    ToolTip="Allow users to postpone installation"/>
                                                                <CheckBox Name="CheckDiskSpaceCheck" Content="Check Disk Space" IsChecked="True" Margin="0,0,0,8"
                                                                    ToolTip="Validate sufficient disk space"/>
                                                                <CheckBox Name="ShowProgressCheck" Content="Show Installation Progress" Margin="0,0,0,8"
                                                                    ToolTip="Display progress dialog"/>
                                                            </UniformGrid>
                                                        </StackPanel>

                                                        <!-- Prerequisites -->
                                                        <StackPanel Margin="0,0,0,20">
                                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                                                <Border Background="#F39C12" Width="20" Height="20" CornerRadius="4" Margin="0,0,8,0">
                                                                    <TextBlock Text="🔍" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="Prerequisites" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                            </StackPanel>

                                                            <UniformGrid Columns="2" Margin="16,0,0,0">
                                                                <CheckBox Name="CheckDotNetCheck" Content="Check .NET Framework" IsChecked="True" Margin="0,0,0,8"
                                                                ToolTip="Auto-install .NET if version lower than 4.5.2"/>
                                                                <CheckBox Name="ImportCertificatesCheck" Content="Import Certificates" Margin="0,0,0,8"
                                                                ToolTip="Add certs to Trusted Publishers store"/>
                                                                <CheckBox Name="CheckVCRedistCheck" Content="Check VC++ Redistributables" Margin="0,0,0,8"
                                                                ToolTip="Validate VC++ runtime dependencies"/>
                                                                <CheckBox Name="RegisterDLLsCheck" Content="Register DLL Modules" Margin="0,0,0,8"
                                                                ToolTip="Register COM components (Register-DLL)"/>
                                                            </UniformGrid>
                                                        </StackPanel>

                                                        <!-- File & Registry Operations -->
                                                        <StackPanel Margin="0,0,0,20">
                                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                                                <Border Background="#9B59B6" Width="20" Height="20" CornerRadius="4" Margin="0,0,8,0">
                                                                    <TextBlock Text="📁" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="File and Registry Operations" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                            </StackPanel>

                                                            <UniformGrid Columns="2" Margin="16,0,0,0">
                                                                <CheckBox Name="CopyToAllUsersCheck" Content="Copy Files to All User Profiles" Margin="0,0,0,8"
                                                                ToolTip="Get-UserProfiles | ForEach Profile"/>
                                                                <CheckBox Name="SetHKCUAllUsersCheck" Content="Set HKCU Registry for All Users" Margin="0,0,0,8"
                                                                 ToolTip="Invoke-HKCURegistrySettingsForAllUsers"/>
                                                                <CheckBox Name="SetCustomRegistryCheck" Content="Set Custom Registry Keys" Margin="0,0,0,8"
                                                                ToolTip="Set-RegistryKey for custom settings"/>
                                                                <CheckBox Name="CopyConfigFilesCheck" Content="Copy Configuration Files" Margin="0,0,0,8"
                                                                ToolTip="Copy-File for custom configs"/>
                                                            </UniformGrid>
                                                        </StackPanel>

                                                        <!-- Shortcuts & Cleanup -->
                                                        <StackPanel Margin="0,0,0,0">
                                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                                                <Border Background="#27AE60" Width="20" Height="20" CornerRadius="4" Margin="0,0,8,0">
                                                                    <TextBlock Text="🔗" FontSize="10" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="Shortcuts and Cleanup" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                                            </StackPanel>

                                                            <UniformGrid Columns="2" Margin="16,0,0,0">
                                                                <CheckBox Name="DesktopShortcutCheck" Content="Desktop Shortcut" Margin="0,0,0,8"
                                                                 ToolTip="New-Shortcut on $envCommonDesktop"/>
                                                                <CheckBox Name="StartMenuEntryCheck" Content="Start Menu Entry" IsChecked="True" Margin="0,0,0,8"
                                                                ToolTip="New-Shortcut in $envCommonStartMenuPrograms"/>
                                                                <CheckBox Name="RemovePreviousVersionsCheck" Content="Remove Previous Versions" Margin="0,0,0,8"
                                                                 ToolTip="Remove-MSIApplications for old versions"/>
                                                                <CheckBox Name="CreateInstallMarkerCheck" Content="Create Install Marker" Margin="0,0,0,8"
                                                                ToolTip="Registry marker for detection"/>
                                                            </UniformGrid>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Border>
                                        </Expander>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Package Status -->
                            <Border Name="PackageStatusPanel" Style="{StaticResource ModernCard}" Visibility="Collapsed">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                        <Border Background="#E8F5E8" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                            <TextBlock Text="📦" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <TextBlock Text="Package Status" FontSize="18" FontWeight="Medium" VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <TextBlock Name="PackageStatusText" Text="Package not created yet" FontSize="14" Margin="0,0,0,8"/>
                                    <TextBlock Name="PackagePathText" Text="" FontSize="12" Foreground="#666666" Margin="0,0,0,16"/>
                                    <Button Name="OpenPackageFolderButton" Content="📂 Open Package Folder" 
                                    Style="{StaticResource SecondaryButton}" Click="OpenPackageFolderButton_Click"
                                    Visibility="Collapsed" HorizontalAlignment="Left"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Action Panel -->
                        <Border Grid.Column="1" Style="{StaticResource ModernCard}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,24">
                                    <Border Background="#FFF3E0" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                        <TextBlock Text="🎯" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="Actions" FontSize="18" FontWeight="Medium" VerticalAlignment="Center"/>
                                </StackPanel>

                                <!-- Step 1: Generate Package -->
                                <Border Background="{StaticResource LightBrush}" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="{StaticResource SuccessBrush}" Width="24" Height="24" CornerRadius="12" Margin="0,0,8,0">
                                                <TextBlock Text="1" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Generate Package" FontWeight="Medium" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <Button Content="🚀 Generate Package" Name="GenerateButton" Click="GenerateButton_Click" 
                            Style="{StaticResource ModernButton}" Background="{StaticResource SuccessBrush}"/>
                                        <TextBlock Text="Creates PSADT folder structure and script template" FontSize="11" 
                               Foreground="#666666" TextWrapping="Wrap" Margin="0,8,0,0"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 2: Edit Script -->
                                <Border Background="{StaticResource LightBrush}" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="{StaticResource SecondaryBrush}" Width="24" Height="24" CornerRadius="12" Margin="0,0,8,0">
                                                <TextBlock Text="2" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Edit Script (Optional)" FontWeight="Medium" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <Button Content="📝 Open Script Editor" Name="OpenScriptButton" Click="OpenScriptButton_Click" 
                                        Style="{StaticResource SecondaryButton}"/>
                                        <TextBlock Text="Customize Deploy-Application.ps1 in PowerShell ISE" FontSize="11" 
                                        Foreground="#666666" TextWrapping="Wrap" Margin="0,8,0,0"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 3: Upload to Intune -->
                                <Border Background="{StaticResource LightBrush}" CornerRadius="8" Padding="16">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Border Background="{StaticResource PrimaryBrush}" Width="24" Height="24" CornerRadius="12" Margin="0,0,8,0">
                                                <TextBlock Text="3" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <TextBlock Text="Upload to Intune" FontWeight="Medium" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <Button Content="☁️ Upload to Intune" Name="UploadButton" Click="UploadButton_Click" 
                                        Style="{StaticResource ModernButton}"/>
                                        <TextBlock Text="Create .intunewin and upload to Microsoft Intune" FontSize="11" 
                                        Foreground="#666666" TextWrapping="Wrap" Margin="0,8,0,0"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- VIEW APPLICATIONS PAGE -->
                    <Grid Name="ViewApplicationsPage" Visibility="Collapsed">
                        <Border Style="{StaticResource ModernCard}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                    <Border Background="#E3F2FD" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                        <TextBlock Text="📱" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="Microsoft Intune Applications" FontSize="20" FontWeight="SemiBold" Foreground="#212529" VerticalAlignment="Center"/>
                                </StackPanel>

                                <!-- Filter Bar -->
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,20">
                                    <TextBox Width="300" Style="{StaticResource ModernTextBox}" 
                                           Text="🔍 Search applications..." Foreground="#999999" Margin="0,0,16,0"/>
                                    <ComboBox Name="CategoryFilter" Width="200" Style="{StaticResource ModernComboBox}" 
                                            SelectedIndex="0" SelectionChanged="CategoryFilter_SelectionChanged" Margin="0,0,16,0"/>
                                </StackPanel>

                                <!-- List Header -->
                                <Border Grid.Row="2" Background="{StaticResource LightBrush}" BorderBrush="#DEE2E6" 
                                      BorderThickness="1" CornerRadius="6,6,0,0" Padding="15,10" Margin="0,0,0,0">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="20"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" Text="Application Name" FontSize="12" FontWeight="SemiBold" Foreground="#495057"/>
                                        <TextBlock Grid.Column="1" Text="Version" FontSize="12" FontWeight="SemiBold" Foreground="#495057" HorizontalAlignment="Center"/>
                                        <TextBlock Grid.Column="2" Text="Category" FontSize="12" FontWeight="SemiBold" Foreground="#495057" HorizontalAlignment="Center"/>
                                        <TextBlock Grid.Column="3" Text="●" FontSize="12" FontWeight="SemiBold" Foreground="#495057" HorizontalAlignment="Center"/>
                                    </Grid>
                                </Border>

                                <!-- Applications List -->
                                <ListView Grid.Row="3" Name="ApplicationsList" BorderThickness="0" Background="Transparent" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                        VirtualizingPanel.IsVirtualizing="True"
                                        VirtualizingPanel.VirtualizationMode="Recycling">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="Margin" Value="0"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#F8F9FA"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListView.ItemContainerStyle>

                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="White" BorderBrush="#DEE2E6" BorderThickness="1,0,1,1" Padding="15,12" Margin="0">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="150"/>
                                                        <ColumnDefinition Width="20"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Application Name Column -->
                                                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding DisplayName}" FontSize="13" FontWeight="SemiBold" 
                                                                 Foreground="#212529" TextTrimming="CharacterEllipsis"/>
                                                        <TextBlock Text="{Binding Id}" FontSize="10" Foreground="#6C757D" 
                                                                 Margin="0,2,0,0" TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>

                                                    <!-- Version Column -->
                                                    <TextBlock Grid.Column="1" Text="{Binding Version}" FontSize="12" 
                                                             Foreground="#495057" VerticalAlignment="Center" 
                                                             HorizontalAlignment="Center" TextTrimming="CharacterEllipsis"/>

                                                    <!-- Category Column -->
                                                    <TextBlock Grid.Column="2" Text="{Binding Category}" FontSize="12" 
                                                             Foreground="#495057" VerticalAlignment="Center" 
                                                             HorizontalAlignment="Center" TextTrimming="CharacterEllipsis"/>

                                                    <!-- Status Indicator -->
                                                    <Border Grid.Column="3" Background="{StaticResource SuccessBrush}" 
                                                          Width="8" Height="8" CornerRadius="4" 
                                                          VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- UPLOAD HISTORY PAGE -->
                    <Grid Name="HistoryPage" Visibility="Collapsed">
                        <Border Style="{StaticResource ModernCard}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                    <Border Background="#FFF3E0" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                        <TextBlock Text="📝" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="Upload History" FontSize="20" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="Upload history and logs will be displayed here..." 
                                         FontSize="14" Foreground="#7F8C8D" FontStyle="Italic"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- SETTINGS PAGE -->
                    <Grid Name="SettingsPage" Visibility="Collapsed">
                        <Border Style="{StaticResource ModernCard}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                    <Border Background="#F5F5F5" Width="32" Height="32" CornerRadius="8" Margin="0,0,12,0">
                                        <TextBlock Text="⚙️" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="Settings" FontSize="20" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock Text="Application settings and configuration options will be available here..." 
                                         FontSize="14" Foreground="#7F8C8D" FontStyle="Italic"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Grid>
            </ScrollViewer>

            <!-- Status Bar -->
            <Border Grid.Row="2" Background="White" Padding="32,16" BorderBrush="#E9ECEF" BorderThickness="0,1,0,0">
                <Grid>
                    <StackPanel Orientation="Horizontal">
                        <Ellipse Fill="#27AE60" Width="12" Height="12" Margin="0,0,8,0"/>
                        <TextBlock Name="StatusText" Text="Ready • Connected to Microsoft Intune" FontSize="12" VerticalAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <TextBlock Text="Last sync: 2 minutes ago" FontSize="11" Foreground="#7F8C8D" VerticalAlignment="Center" Margin="0,0,16,0"/>
                        <ProgressBar Name="ProgressBar" Width="200" Height="6" Visibility="Collapsed" 
                                   Background="#E9ECEF" Foreground="#3498DB" BorderThickness="0"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>